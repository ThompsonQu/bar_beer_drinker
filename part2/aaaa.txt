select A.*, B.bar, B.date, B.time from transactions as A left join bills as B
on A.billId = B.billId where B.drinker = 3326; 


select A.item, B.name, count(A.item) as num from transactions as A left join beer as B on A.item = B. id left join bills as C on A.billId = C.billId where A.type = 'beer' and C.drinker = 8554 group by A.item order by num desc;


select bar, sum(total_price) as total_price, `day` from bills where drinker = 2742 group by day,bar;

select *, Date_FORMAT(date, '%Y%m') months from bills where drinker = 2742 group by months;

select A.drinker, sum(A.total_price) as total_price, B.name from bills as A left join drinker as B on A.drinker = B.id where A.bar = 1 group by A.drinker order by total_price desc limit 10;

select A.bar, B.item, sum(A.total_price) as total_price, C.name from transactions as B right join bills as A on A.billId = B.billId left join beer as C on B.item = C.id where A.bar = 1 and B.type = 'beer' group by B.item order by total_price desc limit 10; 

select A.bar, B.item, sum(A.total_price) as total_price, C.manf as name from transactions as B right join bills as A on A.billId = B.billId left join beer as C on B.item = C.id where A.bar = 1 and B.type = 'beer' group by B.item order by total_price desc limit 5; 

select *, Date_FORMAT(date, '%Y%m') months from bills where drinker = 2742 group by months;

select Date_FORMAT(B.time, '%H') hours, count(A.id) as num from transactions as A left join bills as B on A.billId = B. billId where B.bar = 1 group by hours; 

select B.day, count(A.id) as num from transactions as A left join bills as B on A.billId = B. billId where B.bar = 1 group by B.day; 

select sum(A.quantity) as total, C.name, B.bar from bills as B left join transactions as A on A.billId = B.billId  left join bar as C on B.bar = C.id where A.item = 46 group by B.bar order by total desc; 


select B.drinker, sum(A.quantity) as total from transactions as A left join bills as B on A.billId = B.billId where item = 46 group by B.drinker order by total desc limit 1;

select temp.total, C.name from
(select B.drinker, sum(A.quantity) as total from transactions as A left join bills as B on A.billId = B.billId where item = 46 group by B.drinker) as temp left join drinker as C on temp.drinker = C.id where temp.total = 14;


select Date_FORMAT(B.time, '%H') hours, sum(A.quantity) as num from transactions as A left join bills as B on A.billId = B. billId where A.item = 46 group by hours; 

select B.day, sum(A.quantity) as num from transactions as A left join bills as B on A.billId = B. billId where A.item = 46 group by B.day; 

select month(date) as months, sum(A.quantity) as num from transactions as A left join bills as B on A.billId = B. billId where A.item = 46 group by months;


bar
barfood
beer
bills
drinker
transactions


select count()


2.1
select count(*) > 0 from 
(select A.billId, A.day, A.time, B.start, B.end from bills as A left join operates as B on A.day = B.day and A.bar = B.bar) as temp where time < start or time > end;

2.2
select count(*) from 
(select count(distinct(B.state)) as num from frequents as A left join bar as B on A.bar = B.id group by A.drinker) as temp where num >1 ;

2.3
select count(*) > 0 from 
(select temp1.price1,temp1.price2, temp2.price1 as price3, temp2.price2 as price4 from 
(select A.bar,A.beer as beer1,A.price as price1,B.beer as beer2,B.price as price2 from sellsbeer as A join sellsbeer as B on A.bar = B.bar and A.beer < B.beer) as temp1
left join 
(select A.bar,A.beer as beer1,A.price as price1,B.beer as beer2,B.price as price2 from sellsbeer as A join sellsbeer as B on A.bar = B.bar and A.beer < B.beer) as temp2
on temp1.beer1 = temp2.beer1 and temp1.beer2 = temp2.beer2 and temp1.bar != temp2.bar
having (temp1.price1 - temp1.price2) * (temp2.price1 - temp2.price2) < 0) as temp3
;